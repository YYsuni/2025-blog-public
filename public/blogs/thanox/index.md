# 情景模式说明书

## 配置版入门篇

### 使用要求

将thanox升级到5.0.8以上(越新越好, 因为API可能会随着版本更新)

不论如何请在情景模式右上角引擎中打开su API开关

反复阅读说明书,  遇到问题先看说明书

### 规则导入

**1. 下载后台管家_配置文件版 规则**

一般协同运行的规则会被放在一个文件夹里, 看到必选无脑下载就行.

具体规则名字、规则数量, 这里不会给出, 因为随着时间和设计理念的变化, 规则名字和数量都是不确定的.

以你看到的为准

**2. 从文件导入**

进入thanox情景模式

点击右上角三个点

点击选择文件导入, 左图所示

找到你下载的那几个文件,  依次导入

很简单的, 你一定会, 别让我失望

如果这你都不会, 神仙都会为你流泪的😭

导入后,  确保所有导入的规则开关是打开的(下图右边那个蓝色的)

管家守望者下面提示:

这条情景模式使用了......

这是怎么回事? 我按照大佬说明书弄得, 怎么会酱紫? OMG我只是一只某安小白菜, 我的天塌了.......😭😭😭😭😭

其实......我是故意的

出于某种原因(讲了很多人会头晕), 我特意做出了这个设计, 也许会微乎其微地提高运行效率吧

所以, 你直接忽略它, 继续往下走

**3. 生成配置文件**

   1、进到开拓者内部
   2、复制description『』包裹的指令, 也就是thanos.profileManager.publishStringFact(1,'initConfig',0)
   3、进到Action Console里面
   4、清空里面的所有内容
   5、粘贴第2步复制的指令
   6、右上角点击三角, 运行指令
   7、左下角看到Unit就是成功了

**4. 查看配置文件**

先去管家运行日志的目录自救篇-管家运行日志‌

能看到两个conf文件就代表成功了

管家配置.conf是根据你安装的三方软件来量身定制的. 也就是说, 这个文件在每个人的手机上是不一样的

到此入门篇就结束了,  你已经具备了使用配置版管家的所有条件,  接下来到配置版基础篇跟着配置变量吧

## 配置版基础篇

### 管家配置.conf

```
[时间设置]
初始时间(秒),变化幅度(秒)=60,15

[API设置]
瘦身API=thanoxAPI

[变量设置]

```

开头的都是注释信息, 管家会忽略这一行的所有内容. 所以除去所有的注释后, 你的配置文件应该和上面保持一致

---

### 时间设置

**后台时间 = 初始时间 + 档位 × 变化幅度**

1. 因为管家开拓者生成的变量模板都是0档, 所以 **全局默认后台时间=初始时间**
2. 初始时间就好像水位线, 决定了你的后台时间从哪里开始计算
3. 变化幅度可以决定变化1档, 后台时间变动的大小

以上面的配置为例, `初始时间(秒),变化幅度(秒)=60,15`, 可以得到如下信息:

- 默认后台时间为60秒
- 当设置为1档时, **后台时间=初始时间(60)+档位(1)×变化幅度(15)=75**
- 当设置为-1档时, **后台时间=初始时间(60)+档位（-1）×变化幅度(15)=45**

⚠️ **注意**: 不论你如何设置, 后台时间最低为30秒. 以上面配置为例, 当你设置-2档时, 后台时间已是30, 那么你再设置-3档甚至更低, 都是没有意义的, 全部等价于-2档

---

### API设置

两个选项: `thanoxAPI` 、 `suAPI`

默认是 `thanoxAPI`, 推荐优先使用. 除个人喜好外, 当且仅当本API失效, 改用suAPI

**suAPI**, 用着条件多, 也麻烦. 具体如下:
- 要求在引擎里打开suAPI开关
- 要求灭霸拥有root权限
- 要求灭霸能够自启动, 不被其它因素压制, 后台畅通无阻

---

### 变量设置(❗重点)

```
处理方式  包名  备注  id序列#  档位,计数器  辅助标记
```

所有的模板按照上面的格式生成, 下面来讲解各个部分的含义:

### 处理方式 (不区分大小写):

- **T**: 瘦身应用, 等价于变量版的trimApp
- **K**: 杀死应用, 等价于变量版的killApp
- **M**: 采用内置的逻辑管理音乐类App, 等价于变量版的musicApp

### 包名

字面意思. 保持默认, 不需要更改

### 备注

字面意思. 改成什么无所谓, 但是 **不能有空格**. 保持默认也是可以的

### id序列

保持默认, 不需要更改

### 档位,计数器

- **档位**: 用来控制后台时间的. 默认就是0, 代表0档. 可为负数
- **计数器**: 只有 **处理方式T或者M** 能够开启, 可以控制应用在被瘦身n次后清理掉后台. 默认就是0, 代表关闭计数器. 如果要启用, 最小值为2

### 辅助标记

固定8个零 `00000000`, 可以理解为8个场景开关, 防止某些场景下的误杀. 目前只有前面3个0实现了功能, 后面5个0没有任何作用, 但也不能删除...... 反正只能改前面3个0, 手不要多

- **第一个0**: 改为1, 代表 **有通知时, 管家跳过不处理该应用**
- **第二个0**: 改为1, 代表 **有音频时, 管家跳过不处理该应用**
- **第三个0**: 改为1, 代表 **有前台窗口时, 管家跳过不处理该应用**

---

### 瘦身保留的进程.conf

```
进程名A
进程名B
...
进程名N
```

开头的都是备注信息, 会被管家忽略; 所以去除所有备注后, 你的文件中应该是 **一个进程名独自占据一行**

『不能有任何的其它信息, 比如说我指定0,999; 完全没有必要!!! 只写进程名就好』

### 瘦身保留的进程.conf 什么时候填写?

当且仅当你使用到瘦身功能的时候, 涉及到瘦身的处理方式有:

- **T**: 瘦身应用, 清理应用无用的进程
- **M**: 应用播放音频时瘦身, 停止音频n秒后清理后台

### 为什么我们使用瘦身的时候, 必须得填写 瘦身保留的进程.conf ?

因为如果管家不知道你想保留的进程, 就会默认把所有的进程都清理掉......这个时候就等价于杀后台咯!

所以千万把这一点放在心上: **当你使用 T 或者 M 的处理方式时, 必须在 瘦身保留的进程.conf 中填写保留的有用进程**

---

📌 **到此 基础篇 就结束了, 编辑完你心仪的变量后, 就到 管家启动与关闭 开始你的管家之旅吧!**
